# Logo Extractor 浏览器扩展

一个用于从网页中提取Logo图片并下载的Chrome扩展。

## 功能特点

- 自动扫描网页中的Logo图片
- 支持多种格式（PNG, JPG, SVG, WebP等）
- **强大而深入的扫描引擎**，能够精准提取通过复杂 CSS 背景图（`background-image`）隐藏的 Logo
- 支持下载为不同格式和尺寸
- 简洁直观的用户界面
- **稳定无错的脚本注入**，确保多次使用插件也不会产生控制台错误

## 安装方法

1. 打开Chrome浏览器
2. 进入 `chrome://extensions/`
3. 开启右上角的"开发者模式"
4. 点击"加载已解压的扩展程序"
5. 选择本项目文件夹

## 使用说明

1. 访问任意网站
2. 点击浏览器工具栏中的Logo Extractor图标
3. 插件会自动扫描页面中的Logo
4. 选择需要的Logo并点击下载按钮
5. 可选择下载格式（PNG/JPG）和尺寸

## 技术实现

### content.js
- 注入到页面中，负责执行**深度扫描**。它首先通过一系列通用选择器定位可能的 Logo 区域，然后**递归遍历这些区域及其所有子孙元素**，检查 `<img>` 标签、SVG 元素以及 **CSS 背景图**。脚本还包含一个**注入守卫**，防止在多次点击插件图标时因重复声明变量而报错，保证了运行的稳定性。

### popup.js
- 处理用户界面交互。点击图标时，它会向 `content.js` **发送扫描指令**，并**监听返回的 Logo 候选列表**，然后将结果动态展示给用户。

### background.js
- 提供下载功能的备用实现
- 处理扩展的安装和更新事件

### 文件结构

logo-extractor/
├── manifest.json      # 扩展配置文件
├── content.js         # 内容脚本
├── popup.js           # 弹出窗口脚本
├── popup.html         # 弹出窗口界面
├── popup.css          # 弹出窗口样式
├── background.js      # 后台脚本
├── icons/             # 扩展图标
│   ├── icon16.png
│   ├── icon48.png
│   └── icon128.png
├── bg.jpg             # 棋盘背景图
└── README.md          # 说明文档

## Logo识别算法

本插件采用了一套更可靠的“广度定位、深度扫描”策略：

1. **广泛定位**：首先，使用一系列常见的 Logo 选择器（如 `.logo`, `#logo`, `[class*="brand"]` 等）在页面上快速定位所有可能的 Logo 容器元素。
2. **深度扫描**：对每一个找到的潜在容器，执行递归的深度扫描，遍历该容器**及其所有子孙节点**。
3. **多维提取**：在深度扫描过程中，对每一个被遍历的元素进行全面的检查，提取以下来源的 Logo：
    - **CSS 背景图**：通过 `getComputedStyle` 获取元素的最终样式，并使用正则表达式解析 `background-image` 属性，这是捕获隐藏 Logo 的关键。
    - **`<img>` 标签**：直接从 `src` 或 `data-src` 等属性获取图片 URL。
    - **`<svg>` 元素**：将内联的 SVG 元素序列化，并转换为可直接显示的 Base64 Data URL。
4. **Meta 标签**：扫描页面 `<head>` 中的 `<link>` 标签，提取 `favicon` 或 `apple-touch-icon` 等网站图标。
5. **汇总去重**：将所有来源找到的 URL 进行汇总和去重，最终呈现给用户。

## 注意事项

- 经过优化，现在能**可靠地检测**并提取通过 CSS `background-image` 属性（甚至是应用在**空 `<span>` 或 `<div>`** 等嵌套子元素上）隐藏的 Logo，解决了在搜狐、搜狗等网站上提取失败的问题。
- 支持透明背景的PNG格式Logo。
- 对SVG格式Logo进行了特殊优化处理。
- 下载功能需要用户授权访问下载权限。

## 版本更新

### v1.3.1
- **错误修复**：在 `content.js` 中添加了注入守卫，彻底解决了当用户多次点击插件图标时，因脚本重复注入而导致的 `SyntaxError: Identifier has already been declared` 控制台报错问题。
- 添加插件使用、作者信息

### v1.3
- **修复核心通信 Bug**：修正了 `popup.js` 和 `content.js` 之间的消息传递问题，确保点击插件图标能正确触发新的扫描。
- **重构扫描引擎**：引入深度扫描机制，能够递归检查元素及其所有子孙节点，极大地提高了检测成功率。
- **增强 CSS 背景图提取**：专门优化了对 `background-image` 的提取逻辑，现在可以稳定捕获像搜狗（Sogou）官网那样隐藏在内层空元素上的 Logo。
- **优化代码结构**：精简并统一了检测逻辑，提高了代码的可读性和效率。

### v1.2
- 进一步增强Logo检测功能，支持识别所有包含'logo'关键字的HTML属性和标签
- 改进元素选择器，增强对任意标签中包含logo关键字的检测
- 优化URL处理逻辑，更好地处理相对路径和各种URL格式

### v1.1
- 增强Logo检测功能，支持识别通过CSS背景图片隐藏的Logo
- 添加对特定属性元素（如data-spm）的特殊处理
- 改进URL解析逻辑，更好地处理相对路径
- 优化CSS背景图片检测算法

### v1.0
- 基础Logo提取和下载功能
- 支持多种图片格式
- 简洁的用户界面